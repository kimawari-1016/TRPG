<!DOCTYPE html><html>
<head>
  <meta charset="UTF-8">
  <title>TRPGキャラクターシート</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input[type="text"], input[type="number"] {
      width: 80px;
    }
    table { border-collapse: collapse; margin-bottom: 20px; }
    td, th { border: 1px solid #ccc; padding: 4px 8px; text-align: center; }
    .status-table { margin-bottom: 40px; }
    .skill-row td input[type="text"]:disabled {
      background-color: #eee;
    }
  </style>
</head>
<body>
  <h1>TRPGキャラクターシート</h1>
  <label>名前：<input type="text"></label><br>
  <label>年齢：<input type="number"></label>
  <label>性別：<input type="text"></label><br>
  <label>特色：
    <select id="color" onchange="updateRegion()">
      <option value="白">白</option><option value="黄">黄</option><option value="橙">橙</option><option value="赤">赤</option>
      <option value="紫">紫</option><option value="青">青</option><option value="緑">緑</option><option value="黒">黒</option>
    </select>
  </label>
  <span id="region">シストベリ</span>  <!-- メインステータス -->  <div class="status-table">
    <h3>メインステータス</h3>
    <p>使用可能ポイント：<span id="remainingPoints">250</span></p>
    <table>
      <tr><th></th><th>体力</th><th>精神</th><th>筋力</th><th>俊敏</th><th>器用</th><th>知力</th></tr>
      <tr><td>初期値</td><td><input type="number" id="sta_体" value="30" readonly></td><td><input type="number" id="sta_精" value="30" readonly></td><td><input type="number" id="sta_筋" value="30" readonly></td><td><input type="number" id="sta_俊" value="30" readonly></td><td><input type="number" id="sta_器" value="30" readonly></td><td><input type="number" id="sta_知" value="30" readonly></td></tr>
      <tr><td>割り振り</td><td><input type="number" id="add_体" oninput="updateStats()"></td><td><input type="number" id="add_精" oninput="updateStats()"></td><td><input type="number" id="add_筋" oninput="updateStats()"></td><td><input type="number" id="add_俊" oninput="updateStats()"></td><td><input type="number" id="add_器" oninput="updateStats()"></td><td><input type="number" id="add_知" oninput="updateStats()"></td></tr>
    </table>
  </div>  <!-- 戦闘ステータス -->  <div class="status-table">
    <h3>戦闘ステータス</h3>
    <p>戦闘ステータス用ポイント：<span id="combatPoints">0</span></p>
    <table>
      <tr><th></th><th>HP</th><th>MP</th><th>装甲値</th><th>速度</th><th>後隙</th></tr>
      <tr><td>初期値</td><td><input type="number" id="sta_HP" value="0" readonly></td><td><input type="number" id="sta_MP" value="0" readonly></td><td><input type="number" id="sta_DEF" value="0" readonly></td><td><input type="number" id="sta_SPD" value="0" readonly></td><td><input type="number" id="sta_DLY" value="0" readonly></td></tr>
      <tr><td>割り振り</td><td><input type="number" id="add_HP" oninput="updateStats()"></td><td><input type="number" id="add_MP" oninput="updateStats()"></td><td><input type="number" id="add_DEF" oninput="updateStats()"></td><td><input type="number" id="add_SPD" oninput="updateStats()"></td><td><input type="number" id="add_DLY" oninput="updateStats()"></td></tr>
      <tr><td>合計</td><td><input type="number" id="total_HP" readonly></td><td><input type="number" id="total_MP" readonly></td><td><input type="number" id="total_DEF" readonly></td><td><input type="number" id="total_SPD" readonly></td><td><input type="number" id="total_DLY" readonly></td></tr>
    </table>
  </div>  <!-- スキルステータス -->  <div class="status-table">
    <h3>スキルステータス</h3>
    <p>スキルポイント：<span id="skillPoints">1000</span></p>
    <table id="skillTable">
      <tr><th>技能名</th><th>補足</th><th>割り振り</th></tr>
    </table>
    <button onclick="addSkillRow()">＋技能追加</button>
  </div><script>
  const defaultSkills = [
    "威圧","交渉","乗馬","水泳","登攀","追跡",
    "知識","芸術","創作","礼儀作法","回避","隠密"
  ];

  function createSkillRow(name, isCustom = false) {
    const table = document.getElementById("skillTable");
    const row = table.insertRow();
    row.classList.add("skill-row");

    const cell1 = row.insertCell();
    const cell2 = row.insertCell();
    const cell3 = row.insertCell();

    const nameInput = document.createElement("input");
    nameInput.type = "text";
    nameInput.value = name;
    if (!isCustom) nameInput.disabled = true;
    cell1.appendChild(nameInput);

    const supInput = document.createElement("input");
    supInput.type = "text";
    if (["知識", "芸術", "創作"].includes(name)) {
      supInput.placeholder = "補足";
    } else if (!isCustom) {
      supInput.disabled = true;
    }
    cell2.appendChild(supInput);

    const pointInput = document.createElement("input");
    pointInput.type = "number";
    pointInput.value = "0";
    pointInput.oninput = updateStats;
    cell3.appendChild(pointInput);
  }

  function addSkillRow() {
    createSkillRow("", true);
  }

  function updateRegion() {
    const map = { "白": "シストベリ", "黄": "黄華", "橙": "燈火祖界", "赤": "極紅", "紫": "フィーリラ", "青": "アジュール", "緑": "ヴェルディア", "黒": "メランペプロス" };
    const color = document.getElementById("color").value;
    document.getElementById("region").textContent = map[color];
  }

  function updateStats() {
    const base = 30;
    const keys = ["体", "精", "筋", "俊", "器", "知"];
    let used = 0, stats = {};

    keys.forEach(key => {
      const val = parseInt(document.getElementById("add_"+key).value) || 0;
      used += (val + base > 100) ? 100 + (val - (100 - base)) * 2 - base : val;
      stats[key] = base + val;
      document.getElementById("sta_"+key).value = stats[key];
    });
    document.getElementById("remainingPoints").textContent = 250 - used;

    const hp = 60 + Math.floor(stats["体"] / 5);
    const mp = 30 + Math.floor(stats["精"] / 5);
    const def = Math.floor(stats["筋"] / 20);
    const spd = 20 + Math.floor(stats["俊"] / 10);
    const dly = 25 - Math.floor(stats["器"] / 50);
    const combatBase = 45 + Math.floor(stats["知"] / 10);

    document.getElementById("sta_HP").value = hp;
    document.getElementById("sta_MP").value = mp;
    document.getElementById("sta_DEF").value = def;
    document.getElementById("sta_SPD").value = spd;
    document.getElementById("sta_DLY").value = dly;

    const chp = parseInt(document.getElementById("add_HP").value) || 0;
    const cmp = parseInt(document.getElementById("add_MP").value) || 0;
    const cdf = parseInt(document.getElementById("add_DEF").value) || 0;
    const csp = parseInt(document.getElementById("add_SPD").value) || 0;
    const cdly = parseInt(document.getElementById("add_DLY").value) || 0;
    const combatUsed = chp * 1 + cmp * 1 + cdf * 4 + csp * 2 + cdly * 10;
    const combatRemain = combatBase - combatUsed;

    document.getElementById("combatPoints").textContent = combatRemain;
    document.getElementById("total_HP").value = hp + chp;
    document.getElementById("total_MP").value = mp + cmp;
    document.getElementById("total_DEF").value = def + cdf;
    document.getElementById("total_SPD").value = spd + csp;
    document.getElementById("total_DLY").value = dly + cdly;

    let skillUsed = 0;
    document.querySelectorAll(".skill-row").forEach(row => {
      const name = row.cells[0].querySelector("input").value;
      const val = parseInt(row.cells[2].querySelector("input").value) || 0;
      const cost = val > 100 ? 100 + (val - 100) * 2 : val;
      skillUsed += cost;
    });
    document.getElementById("skillPoints").textContent = 1000 - skillUsed;
  }

  window.onload = function() {
    updateRegion();
    defaultSkills.forEach(skill => createSkillRow(skill));
    updateStats();
  };
</script></body>
</html>
