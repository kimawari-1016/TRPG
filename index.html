<!DOCTYPE html><html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>TRPGキャラクターシート</title>
  <style>
    body { font-family: sans-serif; padding: 10px; max-width: 600px; margin: auto; }
    input[type="number"], input[type="text"] { width: 80px; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
    td, th { border: 1px solid #ccc; padding: 4px 6px; text-align: center; }
    .status-table { margin-bottom: 30px; }
    button { margin-top: 5px; }
    .skill-row, .ability-row { display: flex; align-items: center; gap: 5px; margin-bottom: 5px; }
    .skill-row input[type="text"], .ability-row input[type="text"] { flex: 1; }
  </style>
</head>
<body>
  <h1>TRPGキャラクターシート</h1>
  <label>名前：<input type="text"></label><br>
  <label>年齢：<input type="number"></label>
  <label>性別：<input type="text"></label><br><br><label>特色： <select id="color" onchange="updateRegion()"> <option value="白">白</option> <option value="黄">黄</option> <option value="橙">橙</option> <option value="赤">赤</option> <option value="紫">紫</option> <option value="青">青</option> <option value="緑">緑</option> <option value="黒">黒</option> </select> </label> <span id="region">シストベリ</span>

  <div class="status-table">
    <h3>メインステータス</h3>
    <p>使用可能ポイント：<span id="remainingPoints">250</span></p>
    <table>
      <tr><th></th><th>体力</th><th>精神</th><th>筋力</th><th>俊敏</th><th>器用</th><th>知力</th></tr>
      <tr>
        <td>初期値</td>
        <td><span id="sta_体">30</span></td>
        <td><span id="sta_精">30</span></td>
        <td><span id="sta_筋">30</span></td>
        <td><span id="sta_俊">30</span></td>
        <td><span id="sta_器">30</span></td>
        <td><span id="sta_知">30</span></td>
      </tr>
      <tr>
        <td>割り振り</td>
        <td><input type="number" id="add_体" oninput="updateStats()"></td>
        <td><input type="number" id="add_精" oninput="updateStats()"></td>
        <td><input type="number" id="add_筋" oninput="updateStats()"></td>
        <td><input type="number" id="add_俊" oninput="updateStats()"></td>
        <td><input type="number" id="add_器" oninput="updateStats()"></td>
        <td><input type="number" id="add_知" oninput="updateStats()"></td>
      </tr>
    </table>
  </div>  <div class="status-table">
    <h3>戦闘ステータス</h3>
    <p>戦闘ステータス用ポイント：<span id="combatPoints">0</span></p>
    <table>
      <tr><th></th><th>HP</th><th>MP</th><th>装甲値</th><th>速度</th><th>後隙</th></tr>
      <tr>
        <td>初期値</td>
        <td><span id="sta_HP">0</span></td>
        <td><span id="sta_MP">0</span></td>
        <td><span id="sta_DEF">0</span></td>
        <td><span id="sta_SPD">0</span></td>
        <td><span id="sta_DLY">0</span></td>
      </tr>
      <tr>
        <td>割り振り</td>
        <td><input type="number" id="add_HP" oninput="updateStats()"></td>
        <td><input type="number" id="add_MP" oninput="updateStats()"></td>
        <td><input type="number" id="add_DEF" oninput="updateStats()"></td>
        <td><input type="number" id="add_SPD" oninput="updateStats()"></td>
        <td><input type="number" id="add_DLY" oninput="updateStats()"></td>
      </tr>
      <tr>
        <td>合計</td>
        <td><span id="total_HP">0</span></td>
        <td><span id="total_MP">0</span></td>
        <td><span id="total_DEF">0</span></td>
        <td><span id="total_SPD">0</span></td>
        <td><span id="total_DLY">0</span></td>
      </tr>
    </table>
  </div>  <div class="status-table">
    <h3>技能</h3>
    <p>スキルポイント：<span id="skillPoints">1000</span></p>
    <div id="abilities"></div>
    <button onclick="addAbility()">技能を追加</button>
  </div>  <div class="status-table">
    <h3>スキル</h3>
    <div id="skills"></div>
    <button onclick="addSkill()">スキルを追加</button>
  </div><script>
  const regionMap = {
    "白": "シストベリ", "黄": "黄華", "橙": "燈火祖界", "赤": "極紅",
    "紫": "フィーリラ", "青": "アジュール", "緑": "ヴェルディア", "黒": "メランペプロス"
  };

  function updateRegion() {
    const color = document.getElementById("color").value;
    document.getElementById("region").textContent = regionMap[color];
  }

  function calcCost(val) {
    let cost = 0;
    for (let i = 0; i < val; i++) {
      cost += (i + 30) < 100 ? 1 : 2;
    }
    return cost;
  }

  function updateStats() {
    const keys = ["体", "精", "筋", "俊", "器", "知"];
    let used = 0, stats = {};

    keys.forEach(k => {
      let add = parseInt(document.getElementById("add_" + k).value) || 0;
      let total = 30 + add;
      stats[k] = total;
      used += calcCost(add);
      document.getElementById("sta_" + k).textContent = total;
    });

    let rem = 250 - used;
    document.getElementById("remainingPoints").textContent = rem;
    document.getElementById("remainingPoints").style.color = rem < 0 ? "red" : "black";

    const HP_base = 60 + Math.floor(stats["体"] / 5);
    const MP_base = 30 + Math.floor(stats["精"] / 5);
    const DEF_base = Math.floor(stats["筋"] / 20);
    const SPD_base = 20 + Math.floor(stats["俊"] / 10);
    const DLY_base = 25 - Math.floor(stats["器"] / 50);
    const combatBase = 45 + Math.floor(stats["知"] / 10);

    document.getElementById("sta_HP").textContent = HP_base;
    document.getElementById("sta_MP").textContent = MP_base;
    document.getElementById("sta_DEF").textContent = DEF_base;
    document.getElementById("sta_SPD").textContent = SPD_base;
    document.getElementById("sta_DLY").textContent = DLY_base;

    const add_HP = parseInt(document.getElementById("add_HP").value) || 0;
    const add_MP = parseInt(document.getElementById("add_MP").value) || 0;
    const add_DEF = parseInt(document.getElementById("add_DEF").value) || 0;
    const add_SPD = parseInt(document.getElementById("add_SPD").value) || 0;
    const add_DLY = parseInt(document.getElementById("add_DLY").value) || 0;

    const combatUsed = add_HP * 1 + add_MP * 1 + add_DEF * 4 + add_SPD * 2 + add_DLY * 10;
    const combatRem = combatBase - combatUsed;

    document.getElementById("combatPoints").textContent = Math.max(0, combatRem);
    document.getElementById("combatPoints").style.color = combatRem < 0 ? "red" : "black";

    document.getElementById("total_HP").textContent = HP_base + add_HP;
    document.getElementById("total_MP").textContent = MP_base + add_MP;
    document.getElementById("total_DEF").textContent = DEF_base + add_DEF;
    document.getElementById("total_SPD").textContent = SPD_base + add_SPD;
    document.getElementById("total_DLY").textContent = DLY_base + add_DLY;

    updateSkillPoints();
  }

  function updateSkillPoints() {
    let skillCost = document.querySelectorAll(".skill-row").length * 100;
    let abilityCost = 0;
    document.querySelectorAll(".ability-row input[type=number]").forEach(inp => {
      abilityCost += calcCost(parseInt(inp.value) || 0);
    });
    let total = 1000 - skillCost - abilityCost;
    document.getElementById("skillPoints").textContent = total;
    document.getElementById("skillPoints").style.color = total < 0 ? "red" : "black";
  }

  function addAbility() {
    const container = document.getElementById("abilities");
    const row = document.createElement("div");
    row.className = "ability-row";

    const name = document.createElement("input");
    name.type = "text";
    name.placeholder = "技能名";

    const input = document.createElement("input");
    input.type = "number";
    input.placeholder = "割り振り";
    input.oninput = updateStats;

    const del = document.createElement("button");
    del.textContent = "削除";
    del.onclick = () => { row.remove(); updateStats(); };

    row.appendChild(name);
    row.appendChild(input);
    row.appendChild(del);
    container.appendChild(row);
  }

  function addSkill() {
    const container = document.getElementById("skills");
    const row = document.createElement("div");
    row.className = "skill-row";

    const name = document.createElement("input");
    name.type = "text";
    name.placeholder = "名前";

    const effect = document.createElement("input");
    effect.type = "text";
    effect.placeholder = "効果";

    const del = document.createElement("button");
    del.textContent = "削除";
    del.onclick = () => { row.remove(); updateStats(); };

    row.appendChild(name);
    row.appendChild(effect);
    row.appendChild(del);
    container.appendChild(row);
    updateStats();
  }

  window.onload = updateStats;
</script></body>
</html>
