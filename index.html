<!DOCTYPE html><html>
<head>
  <meta charset="UTF-8">
  <title>TRPGキャラクターシート</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input[type="text"], input[type="number"] {
      width: 80px;
    }
    table { border-collapse: collapse; margin-bottom: 20px; }
    td, th { border: 1px solid #ccc; padding: 4px 8px; text-align: center; }
    .status-table { margin-bottom: 40px; }
    .skill-row input[type="text"]:read-only {
      background-color: #eee;
    }
  </style>
</head>
<body>
  <h1>TRPGキャラクターシート</h1>
  <label>名前：<input type="text"></label><br>
  <label>年齢：<input type="number"></label>
  <label>性別：<input type="text"></label><br>
  <label>特色：
    <select id="color" onchange="updateRegion()">
      <option value="白">白</option>
      <option value="黄">黄</option>
      <option value="橙">橙</option>
      <option value="赤">赤</option>
      <option value="紫">紫</option>
      <option value="青">青</option>
      <option value="緑">緑</option>
      <option value="黒">黒</option>
    </select>
  </label>
  <span id="region">シストベリ</span>  <!-- スキルステータス -->  <div class="status-table">
    <h3>スキルステータス</h3>
    <p>スキルポイント：<span id="skillPoints">1000</span></p>
    <table id="skillTable">
      <tr>
        <th>技能</th><th>補足</th><th>割り振り</th>
      </tr>
    </table>
    <button onclick="addSkillRow()">＋追加</button>
  </div>  <script>
    const initialSkills = [
      "威圧", "交渉", "乗馬", "水泳", "登攀", "追跡",
      "知識", "芸術", "創作", "礼儀作法", "回避", "隠密"
    ];

    function isSupplementAllowed(skill) {
      return ["知識", "芸術", "創作"].includes(skill);
    }

    function createSkillRow(skillName = "", canEdit = true) {
      const tr = document.createElement("tr");
      tr.classList.add("skill-row");

      const skillCell = document.createElement("td");
      const skillInput = document.createElement("input");
      skillInput.type = "text";
      skillInput.value = skillName;
      if (!canEdit) skillInput.readOnly = true;
      skillCell.appendChild(skillInput);

      const suppCell = document.createElement("td");
      const suppInput = document.createElement("input");
      suppInput.type = "text";
      if (!canEdit && !isSupplementAllowed(skillName)) suppInput.readOnly = true;
      suppCell.appendChild(suppInput);

      const pointCell = document.createElement("td");
      const pointInput = document.createElement("input");
      pointInput.type = "number";
      pointInput.min = 0;
      pointInput.value = 0;
      pointInput.oninput = updateSkillPoints;
      pointCell.appendChild(pointInput);

      tr.appendChild(skillCell);
      tr.appendChild(suppCell);
      tr.appendChild(pointCell);

      document.getElementById("skillTable").appendChild(tr);
    }

    function addSkillRow() {
      createSkillRow("", true);
    }

    function updateSkillPoints() {
      let used = 0;
      const rows = document.querySelectorAll(".skill-row");
      rows.forEach(row => {
        const pointInput = row.children[2].children[0];
        let value = parseInt(pointInput.value) || 0;
        const prevValue = parseInt(pointInput.getAttribute("data-prev")) || 0;
        pointInput.setAttribute("data-prev", value);

        // ポイント計算：100を超えるとコスト2倍
        if (value <= 100) {
          used += value;
        } else {
          used += 100 + (value - 100) * 2;
        }
      });
      const remaining = 1000 - used;
      document.getElementById("skillPoints").textContent = remaining;
      document.getElementById("skillPoints").style.color = remaining < 0 ? "red" : "black";
    }

    function updateRegion() {
      const regionMap = {
        "白": "シストベリ", "黄": "黄華", "橙": "燈火祖界", "赤": "極紅",
        "紫": "フィーリラ", "青": "アジュール", "緑": "ヴェルディア", "黒": "メランペプロス"
      };
      const color = document.getElementById("color").value;
      document.getElementById("region").textContent = regionMap[color];
    }

    // 初期技能追加
    window.onload = () => {
      initialSkills.forEach(skill => createSkillRow(skill, false));
      updateSkillPoints();
    };
  </script></body>
</html>
